//     Stratus.Views.Widgets.Calendar.js 1.0
//     Copyright (c) 2016 by Sitetheory, All Rights Reserved
//
//     All information contained herein is, and remains the
//     property of Sitetheory and its suppliers, if any.
//     The intellectual and technical concepts contained herein
//     are proprietary to Sitetheory and its suppliers and may be
//     covered by U.S. and Foreign Patents, patents in process,
//     and are protected by trade secret or copyright law.
//     Dissemination of this information or reproduction of this
//     material is strictly forbidden unless prior written
//     permission is obtained from Sitetheory.
//
//     For full details and documentation:
//     http://docs.sitetheory.io
!function(e,t){"function"==typeof define&&define.amd?define(["stratus","jquery","underscore","moment","stratus.views.widgets.base","fullcalendar"],t):t(e.Stratus,e.$,e._,e.moment)}(this,function(e,t,i,n){e.Views.Widgets.Calendar=e.Views.Widgets.Base.extend({model:e.Models.Generic,template:i.template(""),url:"/Api/",options:{"private":{requiredCssFile:[e.BaseUrl+"sitetheorystratus/stratus/bower_components/fullcalendar/dist/fullcalendar.min.css"]},"public":{customButtons:null,buttonIcons:{prev:"left-single-arrow",next:"right-single-arrow",prevYear:"left-double-arrow",nextYear:"right-double-arrow"},header:{left:"prev,next today",center:"title",right:"month,agendaWeek,agendaDay"},defaultDate:null,nowIndicator:!1,timezone:!1,eventForceAllDay:!1,eventLimit:!1,eventLimitClick:"popover",fixedWeekCount:!1,firstDay:0,weekends:!0,hiddenDays:[],weekNumbers:!1,weekNumberCalculation:"local",businessHours:!1,RTLmode:!1,height:null,contentHeight:null,aspectRatio:1.35,handleWindowResize:!0,windowResizeDelay:100}},initialRequest:!0,onRender:function(e){var t=this;return t.$el.fullCalendar({customButtons:t.options.customButtons,buttonIcons:t.options.buttonIcons,header:t.options.header,defaultDate:t.options.defaultDate,nowIndicator:t.options.nowIndicator,timezone:t.options.timezone,eventLimit:t.options.eventLimit,eventLimitClick:t.options.eventLimitClick,fixedWeekCount:t.options.fixedWeekCount,firstDay:t.options.firstDay,weekends:t.options.weekends,hiddenDays:t.options.hiddenDays,weekNumbers:t.options.weekNumbers,weekNumberCalculation:t.options.weekNumberCalculation,businessHours:t.options.businessHours,isRTL:t.options.RTLmode,height:t.options.height,contentHeight:t.options.contentHeight,aspectRatio:t.options.aspectRatio,handleWindowResize:t.options.handleWindowResize,windowResizeDelay:t.options.windowResizeDelay,events:function(e,i,n,o){t.initialRequest?(t.parseEvents(t.collection,o),t.initialRequest=!1):(console.log("Calendar fetch data!"),console.log("Collection:",t.collection),t.parseEvents(t.collection,o))}}),!0},parseEvents:function(e,t){var o=this,s=[];i.each(e.toJSON().payload,function(e){s.push({id:e.id,title:e.viewVersion.title,start:n.unix(e.viewVersion.timeCustom||e.viewVersion.timePublish||e.time).format(),end:o.options.eventForceAllDay&&e.viewVersion.allDay?null:e.viewVersion.timeEnd||null,url:e.routingPrimary.url,allDay:o.options.eventForceAllDay||e.viewVersion.allDay})}),t(s)}})});