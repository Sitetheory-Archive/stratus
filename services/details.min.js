!function(t,e){"function"==typeof define&&define.amd?define(["stratus","underscore","angular","stratus.services.model"],e):e(t.Stratus,t._)}(this,function(t,e){t.Services.Details=["$provide",function(t){t.factory("details",["$http","model","$interpolate","$q",function(t,n,a,i){return function(){this.fetch=function(t,n){var r=this;return new i(function(i,o){angular.isString(t)&&(t={target:t});var s={selectedid:t.attr?t.attr("data-selectedid"):t.selectedid,property:t.attr?t.attr("data-property"):t.property},c=0;n.$watch(function(){return c},function(t){e.isNumber(t)&&parseInt(t)===e.size(s)&&i(r.build(s,n))}),e.each(s,function(t,e){if(t&&angular.isString(t)){var i=a(t,!1,null,!0),r=i(n.$parent);angular.isDefined(r)?(s[e]=r,c++):n.$watch(function(){return i(n.$parent)},function(t){t&&(s[e]=t,c++)})}else c++})})},this.build=function(e,n){if(e.selectedid){if("version.layout"==e.property)var a="/Api/Layout/"+e.selectedid;if("version.template"==e.property)var a="/Api/Template/"+e.selectedid;action="GET";var i={method:action,url:a,headers:{}};t(i).then(function(t){200===t.status&&angular.isObject(t.data)&&(n.convoyDetails=t.data.payload||t.data,n.selectedName=n.convoyDetails.name,n.selectedDesc=n.convoyDetails.description)})}}}}])}]});