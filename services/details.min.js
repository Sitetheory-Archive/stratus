!function(t,e){"function"==typeof define&&define.amd?define(["stratus","underscore","angular","stratus.services.model"],e):e(t.Stratus,t._,t.angular)}(this,function(t,c,d){t.Services.Details=["$provide",function(t){t.factory("details",["$http","Model","$interpolate","$q",function(a,t,o,e){return function(){this.fetch=function(n,s){var a=this;return new e(function(e,t){d.isString(n)&&(n={target:n});var i={selectedId:n.attr?n.attr("data-selectedId"):n.selectedId,property:n.attr?n.attr("data-property"):n.property},r=0;s.$watch(function(){return r},function(t){c.isNumber(t)&&parseInt(t)===c.size(i)&&e(a.build(i,s))}),c.each(i,function(t,e){if(t&&d.isString(t)){var n=o(t,!1,null,!0),a=n(s.$parent);d.isDefined(a)?(i[e]=a,r++):s.$watch(function(){return n(s.$parent)},function(t){t&&(i[e]=t,r++)})}else r++})})},this.build=function(t,e){if(t.selectedId){var n;"version.layout"===t.property&&(n="/Api/Layout/"+t.selectedId),"version.template"===t.property&&(n="/Api/Template/"+t.selectedId);a({method:"GET",url:n,headers:{}}).then(function(t){200===t.status&&d.isObject(t.data)&&(e.convoyDetails=t.data.payload||t.data,e.selectedName=e.convoyDetails.name,e.selectedDesc=e.convoyDetails.description)})}}}}])}]});