!function(root,factory){"function"==typeof define&&define.amd?define(["stratus","underscore","angular","stratus.services.collection"],factory):factory(root.Stratus,root._)}(this,function(Stratus,_){Stratus.Controllers.UserFilter=["$scope","$log","collection",function($scope,$log,collection){Stratus.Instances[_.uniqueId("user_filter_")]=$scope,$scope.Stratus=Stratus,$scope._=_,$scope.userRoles=[],$scope.showOnly=[],$scope.more=!1,$scope.getStatus=function(member){return status="",member.flags&&($scope.isVerify(member)||(status="unverified")),status},$scope.isVerify=function(member){return!(!member||!member.flags)&&-1!=member.flags.findIndex(function(x){return x.flagType&&"verify"==x.flagType.title})},$scope.init=function(){(collection=new collection).target="Role",collection.urlRoot="/Api/Role",collection.fetch().then(function(response){$scope.userRoles=response})},$scope.toggle=function(roleId){var index=$scope.showOnly.indexOf(roleId);-1!==index?$scope.showOnly.splice(index,1):$scope.showOnly.push(roleId),$scope.collection.meta.set("api.options.identityRoles",$scope.showOnly),$scope.collection.fetch().then(function(response){$log.log("users",response)}),delete $scope.collection.meta.get("api").options};$scope.moreFilter=function(){$scope.more=!$scope.more}}]});