!function(root,factory){"function"==typeof define&&define.amd?define(["stratus","underscore","angular","stratus.services.registry","stratus.services.createNewSite","stratus.services.commonMethods"],factory):factory(root.Stratus,root._)}(this,function(Stratus,_){Stratus.Controllers.CreateNewSite=["$scope","$element","$log","$parse","registry","createNewSite","commonMethods",function($scope,$element,$log,$parse,registry,createNewSite,commonMethods){Stratus.Instances[_.uniqueId("createNewSite_")]=$scope,$scope.registry=new registry,$scope.registry.fetch($element,$scope),$scope.Stratus=Stratus,$scope._=_,$scope.setUrlParams=function(options){if(angular.isObject(options)){var substance=!1;angular.forEach(options,function(value){angular.isDefined(value)&&null!==value&&(angular.isString(value)?value.length>0&&(substance=!0):substance=!0)}),substance&&window.location.replace(Stratus.Internals.SetUrlParams(options))}},$scope.$log=$log,$scope.errorMsg=null,$scope.steps={isWelcome:!0,isThemeSelecting:!1,isSuccess:!1,isBillingPackage:!1},$scope.isArray=angular.isArray,$scope.isDate=angular.isDate,$scope.isDefined=angular.isDefined,$scope.isElement=angular.isElement,$scope.isFunction=angular.isFunction,$scope.isNumber=angular.isNumber,$scope.isObject=angular.isObject,$scope.isString=angular.isString,$scope.isUndefined=angular.isUndefined,$scope.stepFinish=function(name){switch(name){case"ThemeSelecting":$scope.steps.isThemeSelecting=!1,$scope.steps.isSuccess=!0;break;case"Success":$scope.steps.isSuccess=!1,$scope.steps.isBillingPackage=!0}},$scope.createSite=function(siteTitle,siteGenreId){var data={name:siteTitle,genre:siteGenreId};createNewSite.create(data).then(function(res){commonMethods.getStatus(res).code==commonMethods.RESPONSE_CODE().success?($scope.errorMsg=null,$scope.steps.isWelcome=!1,$scope.steps.isThemeSelecting=!0):$scope.errorMsg=commonMethods.getStatus(res).message})},$scope.choosePackage=function(){$scope.steps.isSuccess=!1,$scope.steps.isBillingPackage=!0}}]});