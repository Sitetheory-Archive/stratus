!function(root,factory){"function"==typeof define&&define.amd?define(["stratus","underscore","angular"],factory):factory(root.Stratus,root._,root.angular)}(this,function(Stratus,_,angular){Stratus.Controllers.SelectMainRoute=["$scope","$mdDialog","$rootScope",function($scope,$mdDialog,$rootScope){Stratus.Instances[_.uniqueId("select_main_route_")]=$scope,$scope.Stratus=Stratus,$scope._=_,$scope.routes=[],$scope.routeEmptyMessage=!1,$scope.routeUniqueMessage=!1,$scope.routeRegularEmpMessage=!1,$scope.selectedId=0,$scope.duplecateArr=[],$scope.mainRoute=0,$scope.setAsHomePage=function(model,$event){let confirm=$mdDialog.confirm().title("Set As Home Page").textContent("Are you sure you want to set this current page as your main home page ?   If you confirm, then all traffic to your main domain will load this page. Please also remember that if your current home page does not have a secondary friendly URL, the system will create a temporary URL for it (which you may want to change). And there may not be a way to access that page if its not linked from your menu.").targetEvent($event).ok("Confirm").cancel("Cancel");$mdDialog.show(confirm).then(function(){model.data.main=!0,model.save(),model.data.routing.push({homePage:!0})},function(){return!1})},$scope.$watch("model.data",function(routings){if(routings.routing){let count=1,resetRouting=[];for(let i=0;i<routings.routing.length;i++)routings.routing[i]&&!0===routings.routing[i].main?resetRouting[0]=routings.routing[i]:(resetRouting[count]=routings.routing[i],count++);routings.routing=resetRouting,$scope.routes=routings.routing,angular.forEach($scope.routes,function(route){route.main&&($scope.mainRoute=route.id)})}$rootScope.$$childHead.data.changed=!1}),$scope.update=function(){return angular.forEach($scope.routes,function(route){route.main=route.id===$scope.mainRoute||route.uid===$scope.mainRoute}),$scope.routes},$scope.removeEmptyRoute=function(model,$event,$index){let alias="";alias=void 0!==model.data.routing[$index]&&model.data.routing[$index].url&&void 0!==model.data.routing[$index].url?model.data.routing[$index].url:"";let confirm=$mdDialog.confirm().title("Delete Route").textContent("Are you sure you want to remove the friendly URL alias  '/"+alias+"'  from this page? ").targetEvent($event).ok("Confirm").cancel("Cancel");$mdDialog.show(confirm).then(function(){$scope.routeMessage=!1,model.data.routing.splice($index,1)},function(){return!1})},$scope.checkEmptyRoute=function(model,$event){let lastUrl=$event.$parent.route.url,isMain=model.data.main;if(""===lastUrl&&!0===isMain)$scope.routeEmptyMessage=!0;else{if($scope.routeEmptyMessage=!1,!0===$scope.checkUniqueRoute(model,$event))$scope.routeUniqueMessage=!0,$scope.selectedId=$event.$parent.route.uid;else{$scope.routeUniqueMessage=!1,$scope.selectedId=$event.$parent.route.uid,!0===$scope.checkPattern($event)?($scope.routeRegularEmpMessage=!0,$scope.selectedIds=$event.$parent.route.uid):($scope.routeRegularEmpMessage=!1,$scope.selectedIds=$event.$parent.route.uid)}}},$scope.checkUniqueRoute=function(model,$event){let valueArr=[];return $scope.duplecateArr=[],model.data.routing.map(function(item){valueArr.push(item.url)}),valueArr.some(function(item,idx){valueArr.indexOf(item)!==idx&&($scope.duplecateArr[idx]=idx,$scope.selectedIds=idx)}),$scope.duplecateArr.length>0},$scope.checkPattern=function($event){return!/^([a-z0-9]+)([a-z0-9\_\/\~\.\-])*([a-z0-9]+)$/i.test($event.$parent.route.url)}}]});