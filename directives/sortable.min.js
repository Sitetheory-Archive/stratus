//     Stratus.Directives.Sortable.js 1.0
//     Copyright (c) 2016 by Sitetheory, All Rights Reserved
//
//     All information contained herein is, and remains the
//     property of Sitetheory and its suppliers, if any.
//     The intellectual and technical concepts contained herein
//     are proprietary to Sitetheory and its suppliers and may be
//     covered by U.S. and Foreign Patents, patents in process,
//     and are protected by trade secret or copyright law.
//     Dissemination of this information or reproduction of this
//     material is strictly forbidden unless prior written
//     permission is obtained from Sitetheory.
//
//     For full details and documentation:
//     http://docs.sitetheory.io
!function(root,factory){"function"==typeof define&&define.amd?define(["stratus","sortable","angular"],factory):factory(root.Stratus,root.Sortable)}(this,function(Stratus,Sortable){Stratus.Directives.Sortable=function($parse,$timeout){return{scope:{itemArray:"=ngSortable",listItemSelector:"@ngSortableItemSelector",orderChanged:"&ngSortableOnChange"},link:function(scope,element,attrs){function onGrab(event){originalContainerContent=container.contents()}function onUpdate(event){var clickedItem=angular.element(event.item),itemScope=clickedItem.scope(),originalPosition=itemScope.$index,elementList=slice.call(container.children()),newPosition=elementList.indexOf(clickedItem[0]);container.append(originalContainerContent),scope.$apply(function(){var movedItem=scope.itemArray.splice(originalPosition,1)[0];scope.itemArray.splice(newPosition,0,movedItem)}),scope.orderChanged()}this.uid=_.uniqueId("sortable_"),Stratus.Instances[this.uid]=scope,Stratus.Instances[this.uid+"_element"]=element;var originalContainerContent,sort,container=element,slice=Array.prototype.slice;sort=new Sortable(element[0],{draggable:scope.listItemSelector,onUpdate:onUpdate}),container.on("mousedown",onGrab).on("touchstart",onGrab).on("selectstart",onGrab)}}}});