!function(root,factory){"function"==typeof define&&define.amd?define(["stratus","underscore","zepto","angular"],factory):factory(root.Stratus,root._,root.$)}(this,function(Stratus,_,$){Stratus.Directives.Src=function($parse,$interpolate,$log){return{restrict:"A",scope:{stratusSrc:"@stratusSrc"},link:function($scope,$element,$attrs){if(Stratus.Instances[_.uniqueId("src_")]=$scope,$attrs.stratusSrc){var registered=!1,register=function(){return!!registered||(registered=!0,$element.attr("data-src","lazy"),Stratus.RegisterGroup.add("OnScroll",{method:Stratus.Internals.LoadImage,el:$element,spy:$element.data("spy")?$($element.data("spy")):$element}),void Stratus.Internals.OnScroll())},interpreter=$interpolate($attrs.stratusSrc,!1,null,!0),initial=interpreter($scope.$parent);angular.isDefined(initial)?($element.attr("src",initial),register()):$scope.$watch(function(){return interpreter($scope.$parent)},function(value){angular.isDefined(value)&&($element.attr("src",value),register())})}}}}});