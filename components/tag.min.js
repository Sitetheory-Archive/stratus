!function(root,factory){"function"==typeof define&&define.amd?define(["stratus","underscore","angular","angular-material","stratus.services.commonMethods"],factory):factory(root.Stratus,root._)}(this,function(Stratus,_){Stratus.Components.Tag={bindings:{ngModel:"=",collection:"<"},controller:function($scope,$parse,$attrs,commonMethods){commonMethods.componentInitializer(this,$scope,$attrs,"tag",!0);var $ctrl=this;$ctrl.bindingList=[],$ctrl.selectedChips=[],$ctrl.collection=[],$scope.$watch("$ctrl.ngModel",function(items){$ctrl.bindingList=items,$ctrl.selectedChips=[],angular.forEach(items,function(item){$ctrl.selectedChips.push(item.name)})}),$scope.$watch("$ctrl.collection",function(data){$ctrl.collection=data}),$ctrl.searchData=function(query){var results=$ctrl.collection.filter(query);return Promise.resolve(results).then(function(value){return value.filter(function(item){return-1===$ctrl.selectedChips.indexOf(item.name)})})},$ctrl.transformChip=function(chip){if("object"==typeof chip)return chip.name},$ctrl.addToParent=function(chip){$ctrl.collection.filter(chip).then(function(response){chip=_.isEmpty(response)?{name:chip}:response[0],$ctrl.bindingList.push(chip)})},$ctrl.removeFromParent=function(chip){var index=$ctrl.bindingList.findIndex(function(x){return x.name===chip});$ctrl.bindingList.splice(index,1)}},templateUrl:Stratus.BaseUrl+"sitetheorystratus/stratus/components/tag"+(Stratus.Environment.get("production")?".min":"")+".html"}});