//     Stratus.Components.Publish.js 1.0
//     Copyright (c) 2016 by Sitetheory, All Rights Reserved
//
//     All information contained herein is, and remains the
//     property of Sitetheory and its suppliers, if any.
//     The intellectual and technical concepts contained herein
//     are proprietary to Sitetheory and its suppliers and may be
//     covered by U.S. and Foreign Patents, patents in process,
//     and are protected by trade secret or copyright law.
//     Dissemination of this information or reproduction of this
//     material is strictly forbidden unless prior written
//     permission is obtained from Sitetheory.
//
//     For full details and documentation:
//     http://docs.sitetheory.io
-function(root,factory){"function"==typeof define&&define.amd?define(["stratus","moment","zepto","underscore","angular","stratus.services.model","stratus.components.dateTime"],factory):factory(root.Stratus,root.moment,root.$,root._)}(this,function(Stratus,moment,$,_){Stratus.Components.Publish={bindings:{ngModel:"=",elementId:"@",property:"@",full:"@",action:"@",showDateTime:"@",showUnpublish:"@",showVersionHistory:"@",redirect:"@"},controller:function($scope,$element,$parse,$attrs,$log,model){var uid=_.uniqueId("publish_");return Stratus.Instances[uid]=$scope,$scope.elementId=$attrs.elementId||uid,$scope.property=$attrs.property||null,$scope.full=$attrs.full||!0,_.isString($scope.full)&&($scope.full=_.hydrate($scope.full)),$scope.action="unpublish"===$attrs.action?"unpublish":"publish",$scope.showDateTime=$attrs.showDateTime||!1,$scope.showUnpublish=$attrs.showUnpublish||!1,$scope.showVersionHistory=$attrs.showVersionHistory||!1,$scope.redirect=$attrs.redirect||!1,$scope.propertyTimePublish=$scope.property?$scope.property+".timePublish":null,$scope.showMore=!!($scope.showDateTime||$scope.showUnpublish||$scope.showVersionHistory),$scope.timePublish=null,$scope.model=null,$scope.$watch("$ctrl.ngModel",function(data){data instanceof model&&data!==$scope.model&&($scope.model=data)}),$scope.setTimePublish=function(time){return!(!$scope.model||!$scope.model.get($scope.propertyTimePublish))&&void!$scope.model.set($scope.propertyTimePublish,time||"API::NOW").save()},$scope.$watch("timePublish",function(data){$scope.setTimePublish(data)}),!0},templateUrl:Stratus.BaseUrl+"sitetheorystratus/stratus/components/publish"+(Stratus.Environment.get("production")?".min":"")+".html"}});