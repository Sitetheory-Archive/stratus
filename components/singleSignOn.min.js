!function(root,factory){"function"==typeof define&&define.amd?define(["stratus","underscore","angular","angular-material"],factory):factory(root.Stratus,root._)}(this,function(Stratus,_){Stratus.Components.singleSignOn={bindings:{},controller:function($scope,$window,$attrs,$log,$http,$mdDialog){function FbGetBasicProfile(){FB.api("/me?fields=email,name,gender,locale,link,picture",function(response){console.log("response",response),doSignIn(response,"facebook")},{scope:"email"})}function doSignIn(data,service){data.email?$http({method:"POST",url:loginUrl,data:{service:service,data:data}}).then(function(response){$window.location.href="/"},function(error){console.log(error)}):alert("In order to complete registration you must provide a verified email for account recovery.")}this.uid=_.uniqueId("signle_sign_on_"),Stratus.Internals.CssLoader(Stratus.BaseUrl+"sitetheorystratus/stratus/components/singleSignOn"+(Stratus.Environment.get("production")?".min":"")+".css"),Stratus.Instances[this.uid]=$scope,$scope.elementId=$attrs.elementId||this.uid;this.constructor=function(){!function(){var js=document.createElement("script");js.src="https://apis.google.com/js/platform.js",document.body.appendChild(js);var meta=document.createElement("meta");meta.name="google-signin-client_id",meta.content=ggAppId,document.head.append(meta)}(),window.fbAsyncInit=function(){FB.init({appId:fbAppId,cookie:!0,xfbml:!0,version:"v2.9"}),FB.AppEvents.logPageView()},function(d,s,id){var fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){var js=d.createElement(s);js.id=id,js.src="https://connect.facebook.net/en_US/sdk.js",fjs.parentNode.insertBefore(js,fjs)}}(document,"script","facebook-jssdk")},this.FBStatus=function(){FB.getLoginStatus(function(response){switch(response.status){case"connected":case"not_authorized":FbGetBasicProfile();break;default:FB.login(function(response){null!=response.authResponse?FbGetBasicProfile():FB.login()},{scope:"email"})}},{scope:"email"})};var loginUrl="/Api/Login",fbAppId="753913441463877",ggAppId="878138862061-hsql5u9tcoonjrr99r9f5phcdrao2r8i.apps.googleusercontent.com";window.onbeforeunload=function(e){gapi.auth2.getAuthInstance().signOut()},window.onSignIn=function(googleUser){var profile=googleUser.getBasicProfile();doSignIn({email:profile.getEmail(),name:profile.getName(),id:profile.getId(),picture:profile.getImageUrl()},"google")}},templateUrl:Stratus.BaseUrl+"sitetheorystratus/stratus/components/singleSignOn"+(Stratus.Environment.get("production")?".min":"")+".html"}});