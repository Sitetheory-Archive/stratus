!function(root,factory){"function"==typeof define&&define.amd?define(["stratus","jquery","underscore","angular","angular-material","stratus.services.media"],factory):factory(root.Stratus,root._)}(this,function(Stratus,_){Stratus.Components.MediaDetails={bindings:{ngModel:"=",media:"<",collection:"<"},controller:function($scope,$mdDialog,$attrs,commonMethods,media){commonMethods.componentInitializer(this,$scope,$attrs,"media_details",!0);var $ctrl=this;$ctrl.$onInit=function(){$ctrl.mediaUrl="http://"+$ctrl.media.data.prefix+"."+$ctrl.media.data.extension,$ctrl.tags=$ctrl.media.data.tags.map(function(tag){return tag.name}),$ctrl.selectedName={name:$ctrl.media.data.name,editing:!1},$ctrl.selectedDesc={description:$ctrl.media.data.description,editing:!1},$ctrl.deleteMedia=deleteMedia,$ctrl.dowloadMedia=dowloadMedia,$ctrl.getLinkMedia=getLinkMedia,$ctrl.changeMedia=changeMedia,$ctrl.closeDialog=closeDialog,$ctrl.uploadToLibrary=uploadToLibrary,$ctrl.createTag=createTag,$ctrl.editItem=editItem,$ctrl.doneEditing=doneEditing};function deleteMedia(){var fileId=$ctrl.media.data.id;Stratus.Environment.get("production")||console.log(fileId),$mdDialog.show($mdDialog.confirm().title("DELETE MEDIA").textContent("Are you sure you want to permanently delete this from your library? You may get broken images if any content still uses this image.").multiple(!0).ok("Yes").cancel("No")).then(function(){media.deleteMedia(fileId).then(function(response){commonMethods.getStatus(response).code==commonMethods.RESPONSE_CODE().success?($mdDialog.cancel(),$ctrl.collection.fetch()):$mdDialog.show($mdDialog.alert().parent(angular.element(document.querySelector("#popupContainer"))).clickOutsideToClose(!1).title("Error").multiple(!0).textContent(commonMethods.getStatus(response).message).ok("Ok"))},function(rejection){Stratus.Environment.get("production")||console.log(rejection.data)})})}function dowloadMedia(){console.log("handle dowload event")}function getLinkMedia(){console.log("handle getLink event")}function changeMedia(){console.log($ctrl.media)}function closeDialog(){$mdDialog.cancel()}function uploadToLibrary(files){$scope.$parent.uploadToLibrary(files)}function createTag(query,fileId,tags){var data={name:query};media.createTag(data).then(function(response){if(commonMethods.getStatus(response).code==commonMethods.RESPONSE_CODE().success&&void 0!==fileId&&void 0!==tags){var dataRes={};$ctrl.tags.push(response.data.payload.name),dataRes.tags=$ctrl.tags,updateMedia(fileId,dataRes)}})}function updateMedia(fileId,data){media.updateMedia(fileId,data).then(function(response){commonMethods.getStatus(response).code==commonMethods.RESPONSE_CODE().success&&$ctrl.collection.fetch()})}function editItem(item){item.editing=!0}function doneEditing(fileId,item){var data={};item.description&&(data.description=item.description),item.name&&(data.name=item.name),item.editing=!1,updateMedia(fileId,data)}},templateUrl:Stratus.BaseUrl+"sitetheorystratus/stratus/components/mediaDetails"+(Stratus.Environment.get("production")?".min":"")+".html"}});