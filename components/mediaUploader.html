<div class="media-uploader">
  <div class="toolbar">
    <div class="md-toolbar-tools">
      <h2>Add Media To Library</h2>
      <md-button ng-disabled="$ctrl.uploadingFiles" class="btn gradientAnchor md-button md-ink-ripple" ng-click="$ctrl.done()">Done</md-button>
    </div>
  </div>
  <div class="content">
    <md-tabs md-dynamic-height md-border-bottom>
      <md-tab label="Upload">
        <md-content class="dropContainer md-padding files">
          <p class="description">The files you upload here will be saved on redundant file servers and delivered over a high speed, cached CDN (Content Delivery Network)</p>
          <div class="upload-zone md-padding">
            <h2>Drag and drop files below, or <span>
              <a  href="#"
                  ngf-select="$ctrl.uploadFiles($files, $invalidFiles)"
                  ngf-multiple="$ctrl.ngfMultiple"
                  ngf-max-files="10"
                  ngf-model-invalid="invalidFiles"
                  ngf-validate="{size: {max: '10MB'}, pattern: '.jpg,.pdf,.png'}">browse
              </a></span> your local computer</h2>
            <div class="file-list">
              <ul class="listInline response clearfix">
                <li class="droppedItem" ng-repeat="file in $ctrl.files track by $index" ng-class="!file.errorUpload ? 'uploadComplete' : '' ">
                  <div class="image--cn" ng-class="file.progress >= 0 && !file.errorUpload ? 'progressVisible' : 'progressInvisible' ">
                    <div class="progressPercentage fontBody">{{file.progress}}%</div>
                    <div class="progress">
                      <div ng-if="file.progress >= 0 && !file.errorUpload" class="progressColorBar" style="width:{{file.progress}}%"></div>
                      <span ng-if="!file.errorUpload" class="hover-tick hover-tick-run"></span>
                    </div>
                    <div class="image">
                      <div ng-if="file.type == 'application/x-unknown'" class="droppedUnknown positionCenter">
                        <md-icon md-svg-src="/Api/Resource?path=@SitetheoryCoreBundle:images/contentTypeIcon/document.svg"></md-icon>
                      </div>
                      <img ngf-thumbnail="!file.$error && file">
                      <div class="hoverItems" ng-if="!file.errorUpload && file.upload !== null && file.progress < 100 && !file.upload.aborted">
                        <button title="Abort" ng-click="file.upload.abort(); file.upload.aborted=true" >
                          <md-tooltip>Abort upload</md-tooltip>
                          <i class="fa fa-times-circle" aria-hidden="true"></i>
                        </button>
                      </div>
                      <div ng-if="!file.errorUpload && file.progress === 100" class="successCheck">
                        <md-icon md-svg-src="/Api/Resource?path=@SitetheoryCoreBundle:images/icons/actionButtons/check.svg"></md-icon>
                      </div>
                    </div>
                  </div>
                  <div ng-if="file.errorUpload" class="errorMessage fontBody">
                    {{ file.errorMsg }}
                  </div>
                </li>
                <li class="errorMessage fontBody" ng-repeat="msg in $ctrl.invalidFilesMsg">
                  <div>{{msg}}</div>
                </li>
              </ul>
            </div>
          </div>
        </md-content>
      </md-tab>

      <md-tab label="Video">
        <md-content class="md-padding videos">
          <p class="description">The best way to share videos is to upload to professional video services that offer free storage and bandwidth, as well as sophisticated, browser-compatible video players that vary the quality and formatting based on device. They also have a popular network to widely promote your video. Simply paste the URL to your video and we'll add it to your site as if it's a native video.</p>
          <md-button class="btn gradientAnchor md-button md-ink-ripple" ng-click="$ctrl.uploadVideos()">Save all</md-button>
          <div class="video-list">
            <div class="md-padding video" ng-repeat="video in $ctrl.videos track by $index">
              <form name="videoForm">
                <div layout-gt-sm="row">
                  <md-input-container class="stGrid column20 md-block">
                    <select ng-model="video.service">
                      <option ng-value="service" ng-repeat="service in $ctrl.services.video">
                        {{service.label}}
                      </option>
                    </select>
                  </md-input-container>

                  <div class="stGrid column5"></div>

                  <md-input-container class="stGrid column75 md-block">
                    <label for="url">Full URL</label>
                    <input type="text" name="url" ng-model="video.url" stratus-validate-url service="{{video.service.value}}">
                    <ng-messages for="videoForm.url.$error" ng-if="videoForm.url.$dirty">
                      <ng-message when="validateUrl">Your URL is not a valid {{video.service.label}} link.</ng-message>
                    </ng-messages>
                  </md-input-container>
                </div>

                <div layout-gt-sm="row">
                  <div class="stGrid column45">
                    <md-input-container class="md-block">
                      <label for="videoForm.title">Title</label>
                      <input type="text" name="videoForm.title" ng-model="video.title">
                    </md-input-container>

                    <md-input-container class="md-block">
                      <div id="tagContainer" ng-controller="Generic" data-target="Tag" ng-cloak>
                        <md-chips ng-model="video.tags" name="videoForm.tagModel" md-autocomplete-snap>
                          <md-chip-template>
                            <span md-highlight-text="query">{{ $chip.name }}</span>
                          </md-chip-template>
                          <md-autocomplete
                            flex md-min-length="0"
                            md-delay="500"
                            md-search-text="query"
                            md-items="model in collection.filter(query)"
                            md-item-text="model.name || model.data.name"
                            md-floating-label="Add Tags">
                            <md-chip-template>
                              <span md-highlight-text="query">{{ model.name || model.data.name }}</span>
                            </md-chip-template>
                            <md-not-found>
                              <div ng-click="$ctrl.createTag(query, $ctrl.media.data.id, $ctrl.media.data.tags);">
                                Create New Tag for "{{ query }}" ?
                              </div>
                            </md-not-found>
                          </md-autocomplete>
                        </md-chips>
                      </div>
                    </md-input-container>
                  </div>

                  <div class="stGrid column5"></div>

                  <div class="stGrid column50">
                    <md-input-container class="md-block">
                      <label for="videoForm.description">Description</label>
                      <textarea name="videoForm.description" rows="5" ng-model="video.description"></textarea>
                    </md-input-container>
                  </div>
                </div>

                <md-button ng-if="$ctrl.videos.length > 1" class="btn gradientAnchor md-button md-ink-ripple" ng-click="$ctrl.removeVideo($index)">Remove video -</md-button>
              </form>
            </div>
          </div>
          <md-button class="btn gradientAnchor md-button md-ink-ripple" ng-click="$ctrl.addVideo()">Add video +</md-button>
        </md-content>
      </md-tab>

      <!-- <md-tab label="Link">
        <md-content class="md-padding link">
          <p class="description">If you already have files stored on some other cloud storage, you can add them to your library by just pasting in the URL to the file (or public folder), e.g. Google Drive, Drop Box. Permissions will be set on your third party service, and if you delete the file you will have to manually update your media library.</p>
          <form name="link" ng-submit="$ctrl.uploadByUrl()">
            <md-input-container class="md-block">
              <md-select name="link.services" ng-model="$ctrl.linkServices">
                <md-option ng-value="service.value" ng-repeat="service in $ctrl.link.services" placeholder="Services">{{service.label}}</md-option>
              </md-select>
            </md-input-container>

            <md-input-container class="md-block">
              <input type="url" name="link.url" placeholder="Full URL">
            </md-input-container>

            <md-input-container class="md-block">
              <input type="text" name="link.title" placeholder="Title">
            </md-input-container>

            <md-input-container class="md-block">
              <textarea name="link.description" rows="5" placeholder="Description"></textarea>
            </md-input-container>

            <md-input-container class="md-block">
              <label for="link.tags">Tags</label>
            </md-input-container>

            <md-button class="btn gradientAnchor md-button md-ink-ripple" type="submit">Save</md-button>
          </form>
          <md-button class="btn gradientAnchor md-button md-ink-ripple" ng-click="$ctrl.addUrl()">Add link +</md-button>
        </md-content>
      </md-tab> -->
    </md-tabs>
  </div>
</div>
