!function(a,e){"function"==typeof define&&define.amd?define(["stratus","underscore","swiper","angular","stratus.services.commonMethods"],e):e(a.Stratus,a._,a.Swiper)}(this,function(a,e,t){a.Components.Carousel={bindings:{elementId:"@",initNow:"=",images:"@",imageLinkTarget:"@",direction:"@",transitionEffect:"@",roundLengths:"@",loop:"@",autoHeight:"@",autoplay:"@",autoplayDelay:"@",lazyLoad:"@",navigation:"@",pagination:"@",scrollbar:"@"},controller:["$scope","$attrs","$window","$element","commonMethods",function(i,o,n,r,s){a.Internals.CssLoader(a.BaseUrl+a.BundlePath+"bower_components/swiper/dist/css/swiper"+(a.Environment.get("production")?".min":"")+".css"),s.componentInitializer(this,i,o,"carousel",!0),i.initialized=!1;let l=this;function p(){let a=o.images&&e.isJSON(o.images)?JSON.parse(o.images):[];i.imageLinkTarget=o.imageLinkTarget?o.imageLinkTarget:null,i.direction=o.loop&&"vertical"===o.loop?"vertical":"horizontal",i.transitionEffect=o.transitionEffect?o.transitionEffect:"slide",i.roundLengths=!o.roundLengths||!e.isJSON(o.roundLengths)||JSON.parse(o.roundLengths),i.loop=!o.loop||!e.isJSON(o.loop)||JSON.parse(o.loop),i.gallery=!(!o.gallery||!e.isJSON(o.gallery))&&JSON.parse(o.gallery),i.gallery&&(i.loop=!1),i.scaleHeight=!o.scaleHeight||!e.isJSON(o.scaleHeight)||JSON.parse(o.scaleHeight),i.allowZoom=!(!o.allowZoom||!e.isJSON(o.allowZoom))&&JSON.parse(o.allowZoom),i.scaleHeight=i.scaleHeight||i.allowZoom,i.stretchWidth=!(!o.stretchWidth||!e.isJSON(o.stretchWidth))&&JSON.parse(o.stretchWidth),i.autoHeight=!(!o.autoHeight||!e.isJSON(o.autoHeight))&&JSON.parse(o.autoHeight),i.autoplay=!(!o.autoplay||!e.isJSON(o.autoplay))&&JSON.parse(o.autoplay),i.allowTouchMove=!o.allowTouchMove||!e.isJSON(o.allowTouchMove)||JSON.parse(o.allowTouchMove),i.transitionDelay=o.transitionDelay&&e.isJSON(o.transitionDelay)?JSON.parse(o.transitionDelay):3e3,i.lazyLoad=o.lazyLoad&&e.isJSON(o.lazyLoad)?JSON.parse(o.lazyLoad):{},i.navigation=!o.navigation||!e.isJSON(o.navigation)||JSON.parse(o.navigation),i.pagination=!(!o.pagination||!e.isJSON(o.pagination))&&JSON.parse(o.pagination),i.scrollbar=!(!o.scrollbar||!e.isJSON(o.scrollbar))&&JSON.parse(o.scrollbar),function(a){"string"==typeof a&&(a=[a]);if(e.isArray(a)){let e=[];a.forEach(function(a){let t={};"string"==typeof a?t.src=a:"object"==typeof a&&a.hasOwnProperty("src")&&(t=a),Object.keys(t).length>0&&e.push(t)}),e.length>0&&(i.images=e,console.log("prepped ",e.length,"images"),i.images.length<2&&(i.loop=!1,i.allowTouchMove=!1))}}(a),function(){l.swiperContainer=r[0].getElementsByClassName("swiper-main")[0].getElementsByClassName("swiper-container")[0],l.swiperParameters={direction:i.direction,zoom:i.allowZoom,loop:i.loop,effect:i.transitionEffect,autoHeight:i.autoHeight,allowTouchMove:i.allowTouchMove},i.navigation&&(l.swiperNextEl=l.swiperContainer.getElementsByClassName("swiper-button-next")[0],l.swiperPrevEl=l.swiperContainer.getElementsByClassName("swiper-button-prev")[0],l.swiperParameters.navigation={nextEl:l.swiperNextEl,prevEl:l.swiperPrevEl});if(i.pagination){if(l.swiperParameters.pagination={},"object"==typeof i.pagination&&(i.pagination.hasOwnProperty("el")&&(l.swiperPaginationEl=l.swiperContainer.getElementsByClassName(i.pagination.el)[0]),i.pagination.hasOwnProperty("clickable")&&(l.swiperParameters.pagination.clickable=i.pagination.clickable),i.pagination.hasOwnProperty("dynamicBullets")&&(l.swiperParameters.pagination.dynamicBullets=i.pagination.dynamicBullets),i.pagination.hasOwnProperty("dynamicMainBullets")&&(l.swiperParameters.pagination.dynamicMainBullets=i.pagination.dynamicMainBullets),i.pagination.hasOwnProperty("render")))switch(i.pagination.render){case"fraction":l.swiperParameters.pagination.type="fraction";break;case"customFraction":l.swiperParameters.pagination.type="fraction",l.swiperParameters.pagination.renderFraction=function(a,e){return'<span class="'+a+'"></span> of <span class="'+e+'"></span>'};break;case"progressbarOpposite":l.swiperParameters.pagination.progressbarOpposite=!0,l.swiperParameters.pagination.type="progressbar";break;case"progressbar":l.swiperParameters.pagination.type="progressbar";break;case"numberBullet":l.swiperParameters.pagination.renderBullet=function(a,e){return'<span class="'+e+' swiper-pagination-number-bullet">'+(a+1)+"</span>"};break;case"bullet":default:l.swiperParameters.pagination.type="bullet"}l.swiperPaginationEl||(l.swiperPaginationEl=l.swiperContainer.getElementsByClassName("swiper-pagination")[0]),l.swiperParameters.pagination.el=l.swiperPaginationEl}i.scrollbar&&(l.swiperScrollbarEl=l.swiperContainer.getElementsByClassName("swiper-scrollbar")[0],l.swiperParameters.scrollbar={el:l.swiperScrollbarEl});i.autoplay&&(!0===i.autoplay&&(i.autoplay={delay:i.transitionDelay,disableOnInteraction:!1}),!i.loop&&i.autoplay&&("boolean"==typeof i.autoplay&&(i.autoplay={}),i.autoplay.hasOwnProperty("stopOnLastSlide")||(i.autoplay.stopOnLastSlide=!0)),l.swiperParameters.autoplay=i.autoplay);i.lazyLoad&&(!0===i.lazyLoad&&(i.lazyLoad={}),i.lazyLoad&&!i.lazyLoad.hasOwnProperty("loadPrevNext")&&(i.lazyLoad.loadPrevNext=!0),i.lazyLoad&&!i.lazyLoad.hasOwnProperty("loadPrevNextAmount")&&(i.lazyLoad.loadPrevNextAmount=1),i.lazyLoad&&!i.lazyLoad.hasOwnProperty("loadOnTransitionStart")&&(i.lazyLoad.loadOnTransitionStart=!0),l.swiperParameters.lazy=i.lazyLoad,l.swiperParameters.preloadImages=!1);i.$applyAsync(function(){l.swiper=new t(l.swiperContainer,l.swiperParameters),i.gallery&&(l.galleryContainer=r[0].getElementsByClassName("swiper-gallery")[0].getElementsByClassName("swiper-container")[0],l.gallerySwiper=new t(l.galleryContainer,{direction:"horizontal",effect:"slide",preloadImages:!1,spaceBetween:10,centeredSlides:!0,slidesPerView:8,touchRatio:.2,slideToClickedSlide:!0}),l.swiper.controller.control=l.gallerySwiper,l.gallerySwiper.controller.control=l.swiper)})}(),i.initialized=!0}l.$onInit=function(){let a=!0;o.$attr.hasOwnProperty("initNow")&&(a=!!e.isJSON(o.initNow)&&JSON.parse(o.initNow)),a?p():l.stopWatchingInitNow=i.$watch("$ctrl.initNow",function(a){!0===a&&(i.initialized||(console.log("initing!"),p()),l.stopWatchingInitNow())})},i.imageClick=function(a,e){a&&a.hasOwnProperty("link")&&n.open(a.link,i.imageLinkTarget||a.target||"_self")}}],templateUrl:a.BaseUrl+a.BundlePath+"components/carousel"+(a.Environment.get("production")?".min":"")+".html"}});